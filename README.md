# ImgStream - ÂÜôÁúüÁÆ°ÁêÜ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥

[![Build Status](https://github.com/your-org/imgstream/workflows/CI%2FCD%20Pipeline/badge.svg)](https://github.com/your-org/imgstream/actions)
[![Security Scan](https://github.com/your-org/imgstream/workflows/Security%20Scan/badge.svg)](https://github.com/your-org/imgstream/actions)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

ImgStream„ÅØ„ÄÅPython„ÄÅStreamlit„ÄÅGoogle Cloud Platform„ÅßÊßãÁØâ„Åï„Çå„ÅüÁèæ‰ª£ÁöÑ„Å™„ÇØ„É©„Ç¶„Éâ„Éç„Ç§„ÉÜ„Ç£„ÉñÂÜôÁúüÁÆ°ÁêÜ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Åß„Åô„ÄÇ„Ç®„É≥„Çø„Éº„Éó„É©„Ç§„Ç∫„Ç∞„É¨„Éº„Éâ„ÅÆÁõ£Ë¶ñ„Å®„Éá„Éó„É≠„Ç§„É°„É≥„ÉàËá™ÂãïÂåñ„ÇíÂÇô„Åà„Åü„ÄÅÂÆâÂÖ®„Å™ÂÜôÁúü„ÅÆ„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„ÄÅ‰øùÂ≠ò„ÄÅÁÆ°ÁêÜÊ©üËÉΩ„ÇíÊèê‰æõ„Åó„Åæ„Åô„ÄÇ

## üöÄ Ê©üËÉΩ

- **ÂÆâÂÖ®„Å™ÂÜôÁúü„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Éª‰øùÂ≠ò**: Ëá™Âãï„Çµ„É†„Éç„Ç§„É´ÁîüÊàê‰ªò„Åç„ÅÆÂÜôÁúü„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ
- **„ÇØ„É©„Ç¶„Éâ„Éç„Ç§„ÉÜ„Ç£„Éñ„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£**: Ëá™Âãï„Çπ„Ç±„Éº„É™„É≥„Ç∞ÂØæÂøú„ÅÆGoogle Cloud RunÊßãÁØâ
- **„Ç®„É≥„Çø„Éº„Éó„É©„Ç§„Ç∫Ë™çË®º**: Êú¨Áï™Áí∞Â¢ÉÂêë„ÅëGoogle Cloud IAPÁµ±Âêà
- **„É™„Ç¢„É´„Çø„Ç§„É†Áõ£Ë¶ñ**: Cloud Monitoring„Å´„Çà„ÇãÂåÖÊã¨ÁöÑ„Å™„É°„Éà„É™„ÇØ„Çπ„Å®„Ç¢„É©„Éº„Éà
- **Ëá™ÂãïÂåñCI/CD**: GitHub Actions„Å®Cloud Build„ÅÆÁµ±Âêà
- **„Éû„É´„ÉÅÁí∞Â¢É„Çµ„Éù„Éº„Éà**: ÈñãÁô∫„ÄÅ„Çπ„ÉÜ„Éº„Ç∏„É≥„Ç∞„ÄÅÊú¨Áï™Áí∞Â¢É„ÅÆË®≠ÂÆö
- **„Çª„Ç≠„É•„É™„ÉÜ„Ç£„Éï„Ç°„Éº„Çπ„Éà**: ÁµÑ„ÅøËæº„Åø„Çª„Ç≠„É•„É™„ÉÜ„Ç£„Çπ„Ç≠„É£„É≥„Å®„Ç≥„É≥„Éó„É©„Ç§„Ç¢„É≥„Çπ„ÉÅ„Çß„ÉÉ„ÇØ
- **„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊúÄÈÅ©Âåñ**: ÂäπÁéáÁöÑ„Å™ÁîªÂÉèÂá¶ÁêÜ„Å®„Ç≠„É£„ÉÉ„Ç∑„É≥„Ç∞

## üìã ÁõÆÊ¨°

- [„ÇØ„Ç§„ÉÉ„ÇØ„Çπ„Çø„Éº„Éà](#„ÇØ„Ç§„ÉÉ„ÇØ„Çπ„Çø„Éº„Éà)
- [„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£](#„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£)
- [„Ç§„É≥„Çπ„Éà„Éº„É´](#„Ç§„É≥„Çπ„Éà„Éº„É´)
- [Ë®≠ÂÆö](#Ë®≠ÂÆö)
- [„Éá„Éó„É≠„Ç§„É°„É≥„Éà](#„Éá„Éó„É≠„Ç§„É°„É≥„Éà)
- [Áõ£Ë¶ñ](#Áõ£Ë¶ñ)
- [ÈñãÁô∫](#ÈñãÁô∫)
- [„ÉÜ„Çπ„Éà](#„ÉÜ„Çπ„Éà)
- [„Éà„É©„Éñ„É´„Ç∑„É•„Éº„ÉÜ„Ç£„É≥„Ç∞](#„Éà„É©„Éñ„É´„Ç∑„É•„Éº„ÉÜ„Ç£„É≥„Ç∞)
- [„É©„Ç§„Çª„É≥„Çπ](#„É©„Ç§„Çª„É≥„Çπ)

## üèÉ‚Äç‚ôÇÔ∏è „ÇØ„Ç§„ÉÉ„ÇØ„Çπ„Çø„Éº„Éà

### ÂâçÊèêÊù°‰ª∂

- Python 3.11+
- Google Cloud Platform„Ç¢„Ç´„Ç¶„É≥„Éà
- DockerÔºà„Ç≥„É≥„ÉÜ„ÉäÂåñ„Éá„Éó„É≠„Ç§„É°„É≥„ÉàÁî®Ôºâ
- uv„Éë„ÉÉ„Ç±„Éº„Ç∏„Éû„Éç„Éº„Ç∏„É£„Éº

### „É≠„Éº„Ç´„É´ÈñãÁô∫Áí∞Â¢É„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó

1. **„É™„Éù„Ç∏„Éà„É™„ÅÆ„ÇØ„É≠„Éº„É≥**
   ```bash
   git clone https://github.com/your-org/imgstream.git
   cd imgstream
   ```

2. **‰æùÂ≠òÈñ¢‰øÇ„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´**
   ```bash
   # uv„Åå„Ç§„É≥„Çπ„Éà„Éº„É´„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÅØ„Ç§„É≥„Çπ„Éà„Éº„É´
   curl -LsSf https://astral.sh/uv/install.sh | sh
   
   # „Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆ‰æùÂ≠òÈñ¢‰øÇ„Çí„Ç§„É≥„Çπ„Éà„Éº„É´
   uv sync
   ```

3. **Áí∞Â¢ÉÂ§âÊï∞„ÅÆË®≠ÂÆö**
   ```bash
   cp .env.example .env
   # .env„Éï„Ç°„Ç§„É´„ÇíË®≠ÂÆö„Å´Âêà„Çè„Åõ„Å¶Á∑®ÈõÜ
   ```

4. **„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆÂÆüË°å**
   ```bash
   uv run streamlit run src/imgstream/main.py
   ```

5. **„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Å∏„ÅÆ„Ç¢„ÇØ„Çª„Çπ**
   „Éñ„É©„Ç¶„Ç∂„Åß `http://localhost:8501` „ÇíÈñã„Åè

## üèóÔ∏è „Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£

ImgStream„ÅØ„ÄÅ„Çπ„Ç±„Éº„É©„Éì„É™„ÉÜ„Ç£„ÄÅ„Çª„Ç≠„É•„É™„ÉÜ„Ç£„ÄÅ‰øùÂÆàÊÄß„ÇíËÄÉÊÖÆ„Åó„Å¶Ë®≠Ë®à„Åï„Çå„ÅüÁèæ‰ª£ÁöÑ„Å™„ÇØ„É©„Ç¶„Éâ„Éç„Ç§„ÉÜ„Ç£„Éñ„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„Å´Âæì„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ

### È´ò„É¨„Éô„É´„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£

```mermaid
graph TB
    User[üë§ User] --> LB[üîÑ Load Balancer]
    LB --> IAP[üîê Identity-Aware Proxy]
    IAP --> CR[‚òÅÔ∏è Cloud Run]
    CR --> GCS[üì¶ Cloud Storage]
    CR --> DB[(üóÑÔ∏è Database)]
    CR --> MON[üìä Cloud Monitoring]
    
    subgraph "Cloud Run Service"
        CR --> APP[üì± Streamlit App]
        APP --> AUTH[üîë Auth Service]
        APP --> STORAGE[üíæ Storage Service]
        APP --> IMG[üñºÔ∏è Image Processing]
    end
    
    subgraph "CI/CD Pipeline"
        GH[üìö GitHub] --> GA[‚ö° GitHub Actions]
        GA --> CB[üî® Cloud Build]
        CB --> GCR[üì¶ Container Registry]
        GCR --> CR
    end
    
    subgraph "Monitoring & Alerting"
        MON --> DASH[üìà Dashboards]
        MON --> ALERT[üö® Alerts]
        ALERT --> EMAIL[üìß Email]
        ALERT --> SLACK[üí¨ Slack]
    end
```

### „Ç≥„É≥„Éù„Éº„Éç„É≥„ÉàÊ¶ÇË¶Å

| „Ç≥„É≥„Éù„Éº„Éç„É≥„Éà | ÊäÄË°ì | ÁõÆÁöÑ |
|-----------|------------|---------|
| **Web„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥** | Streamlit | Web„Éô„Éº„Çπ„ÅÆ„É¶„Éº„Ç∂„Éº„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ |
| **„Éì„Ç∏„Éç„Çπ„É≠„Ç∏„ÉÉ„ÇØ** | Python Services | Ë™çË®º„ÄÅ„Çπ„Éà„É¨„Éº„Ç∏„ÄÅÁîªÂÉèÂá¶ÁêÜ„Çµ„Éº„Éì„Çπ |
| **Ë™çË®º** | Google Cloud IAP | „Ç¢„Ç§„Éá„É≥„ÉÜ„Ç£„ÉÜ„Ç£„Å®„Ç¢„ÇØ„Çª„ÇπÁÆ°ÁêÜ |
| **„Çπ„Éà„É¨„Éº„Ç∏** | Google Cloud Storage | ÂÜôÁúü„Å®„Éï„Ç°„Ç§„É´„ÅÆ‰øùÂ≠ò |
| **„Éá„Éº„Çø„Éô„Éº„Çπ** | DuckDB | „É°„Çø„Éá„Éº„Çø„Å®„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Éá„Éº„Çø |
| **„Ç≥„É≥„ÉÜ„Éä** | Docker | „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆ„Ç≥„É≥„ÉÜ„ÉäÂåñ |
| **„Ç™„Éº„Ç±„Çπ„Éà„É¨„Éº„Ç∑„Éß„É≥** | Cloud Run | „Çµ„Éº„Éê„Éº„É¨„Çπ„Ç≥„É≥„ÉÜ„Éä„Éó„É©„ÉÉ„Éà„Éï„Ç©„Éº„É† |
| **CI/CD** | GitHub Actions | Ëá™Âãï„Éá„Éó„É≠„Ç§„É°„É≥„Éà„Éë„Ç§„Éó„É©„Ç§„É≥ |
| **Áõ£Ë¶ñ** | Cloud Monitoring | „É°„Éà„É™„ÇØ„Çπ„ÄÅ„É≠„Ç∞„ÄÅ„Ç¢„É©„Éº„Éà |

### „Çª„Ç≠„É•„É™„ÉÜ„Ç£„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£

```mermaid
graph LR
    Internet[üåê Internet] --> CDN[üîÑ CDN/Load Balancer]
    CDN --> WAF[üõ°Ô∏è Web Application Firewall]
    WAF --> IAP[üîê Identity-Aware Proxy]
    IAP --> CR[‚òÅÔ∏è Cloud Run]
    
    subgraph "Security Layers"
        IAP --> JWT[üé´ JWT Validation]
        CR --> RBAC[üë• Role-Based Access]
        CR --> CSRF[üîí CSRF Protection]
        CR --> RATE[‚è±Ô∏è Rate Limiting]
    end
    
    subgraph "Data Security"
        CR --> ENC[üîê Encryption at Rest]
        CR --> TLS[üîí TLS in Transit]
        CR --> AUDIT[üìù Audit Logging]
    end
```

## üíª „Ç§„É≥„Çπ„Éà„Éº„É´

### Development Environment

1. **System Requirements**
   - Python 3.11 or higher
   - 4GB RAM minimum (8GB recommended)
   - 10GB free disk space

2. **Install Python Dependencies**
   ```bash
   # Using uv (recommended)
   uv sync
   
   # Or using pip
   pip install -r requirements.txt
   ```

3. **Install Development Tools**
   ```bash
   # Code formatting and linting
   uv add --dev black ruff mypy
   
   # Testing tools
   uv add --dev pytest pytest-cov pytest-asyncio
   ```

### Production Environment

See the [Deployment Guide](docs/DEPLOYMENT.md) for detailed production setup instructions.

## ‚öôÔ∏è Configuration

ImgStream uses environment-specific YAML configuration files located in `config/environments/`:

- `development.yaml` - Local development settings
- `staging.yaml` - Staging environment settings
- `production.yaml` - Production environment settings

### Environment Variables

| Variable | Description | Required | Default |
|----------|-------------|----------|---------|
| `ENVIRONMENT` | Deployment environment | Yes | `development` |
| `GOOGLE_CLOUD_PROJECT` | GCP project ID | Yes | - |
| `GCS_BUCKET_*` | Storage bucket per environment | Yes | - |
| `IAP_AUDIENCE` | IAP audience for authentication | Production | - |

### Configuration Example

```yaml
# config/environments/production.yaml
environment: production

app:
  debug: false
  log_level: WARNING
  host: "0.0.0.0"
  port: 8080

auth:
  development_mode: false
  bypass_iap: false
  iap_audience: "${IAP_AUDIENCE}"

storage:
  type: "gcs"
  gcs_bucket: "${GCS_BUCKET_PRODUCTION}"
  signed_url_expiration: 1800

performance:
  max_file_size: 104857600  # 100MB
  thumbnail_size: [400, 400]
  concurrent_uploads: 20

security:
  csrf_protection: true
  rate_limiting: true
  cors_origins: ["https://imgstream.example.com"]
```

## üöÄ Deployment

ImgStream supports multiple deployment methods:

### 1. GitHub Actions (Recommended)

Automated deployment triggered by:
- **Staging**: Push to `develop` branch
- **Production**: Push to `main` branch or create release tag

```bash
# Deploy to staging
git push origin develop

# Deploy to production
git tag v1.0.0
git push origin v1.0.0
```

### 2. Manual Deployment

```bash
# Validate configuration
./scripts/validate-deployment-config.sh production

# Deploy to production
ENVIRONMENT=production ./scripts/deploy-cloud-run.sh
```

### 3. Cloud Build

```bash
# Deploy using Cloud Build
gcloud builds submit --config cloudbuild.yaml \
  --substitutions _ENVIRONMENT=production
```

For detailed deployment instructions, see [Deployment Guide](docs/DEPLOYMENT.md).

## üìä Monitoring

ImgStream includes comprehensive monitoring and alerting:

### Metrics Dashboard

Access the monitoring dashboard at:
`https://console.cloud.google.com/monitoring/dashboards`

### Key Metrics

- **Request Rate**: Requests per second
- **Error Rate**: Percentage of failed requests
- **Response Time**: 95th percentile latency
- **Resource Usage**: CPU and memory utilization
- **Storage Usage**: GCS bucket utilization

### Alerts

Automatic alerts for:
- Service availability < 99%
- Error rate > 5%
- Response time > 2 seconds
- Resource usage > 80%
- Storage usage > 80GB

### Setup Monitoring

```bash
# Configure monitoring and alerts
ENVIRONMENT=production ./scripts/setup-monitoring.sh
```



## üõ†Ô∏è Development

### Development Workflow

1. **Create feature branch**
   ```bash
   git checkout -b feature/new-feature
   ```

2. **Make changes and test**
   ```bash
   # Run tests
   uv run pytest
   
   # Code formatting
   uv run black .
   uv run ruff check .
   
   # Type checking
   uv run mypy src/
   ```

3. **Commit and push**
   ```bash
   git add .
   git commit -m "feat: add new feature"
   git push origin feature/new-feature
   ```

4. **Create pull request**
   - Automated tests will run
   - Code review required
   - Merge to `develop` for staging deployment

### Code Quality

The project enforces code quality through:

- **Black**: Code formatting
- **Ruff**: Fast Python linter
- **MyPy**: Static type checking
- **Pytest**: Unit and integration testing

### Pre-commit Hooks

Install pre-commit hooks for automatic code quality checks:

```bash
uv add --dev pre-commit
uv run pre-commit install
```

## üß™ Testing

### Test Structure

```
tests/
‚îú‚îÄ‚îÄ unit/           # Unit tests
‚îú‚îÄ‚îÄ integration/    # Integration tests
‚îú‚îÄ‚îÄ e2e/           # End-to-end tests
‚îú‚îÄ‚îÄ security/      # Security tests
‚îî‚îÄ‚îÄ performance/   # Performance tests
```

### Running Tests

```bash
# All tests
uv run pytest

# Unit tests only
uv run pytest tests/unit/

# With coverage
uv run pytest --cov=src/imgstream --cov-report=html

# Security tests
ENVIRONMENT=production uv run pytest tests/security/

# Performance tests
uv run pytest tests/performance/
```

### Test Configuration

Tests use environment-specific configuration:

```bash
# Test with staging configuration
ENVIRONMENT=staging uv run pytest tests/integration/

# Test with production configuration
ENVIRONMENT=production uv run pytest tests/security/
```

## üîß Troubleshooting

### Common Issues

#### 1. Authentication Errors

**Problem**: `401 Unauthorized` errors in production

**Solution**:
```bash
# Check IAP configuration
gcloud iap web get-iam-policy --resource-type=backend-services \
  --service=imgstream-production

# Verify service account permissions
gcloud projects get-iam-policy $GOOGLE_CLOUD_PROJECT
```

#### 2. Storage Issues

**Problem**: Cannot upload files or access storage

**Solution**:
```bash
# Check bucket permissions
gsutil iam get gs://your-bucket-name

# Test bucket access
gsutil ls gs://your-bucket-name

# Check service account key
gcloud auth activate-service-account --key-file=service-account-key.json
```

#### 3. Deployment Failures

**Problem**: Cloud Run deployment fails

**Solution**:
```bash
# Check build logs
gcloud builds log [BUILD_ID]

# Validate configuration
./scripts/validate-deployment-config.sh production

# Check service logs
gcloud logs read "resource.type=cloud_run_revision" --limit=50
```

#### 4. Performance Issues

**Problem**: Slow response times or high resource usage

**Solution**:
```bash
# Check monitoring dashboard
# https://console.cloud.google.com/monitoring

# Analyze performance metrics
./scripts/deployment-monitor.sh status

# Review resource allocation
gcloud run services describe imgstream-production --region=us-central1
```

### Getting Help

1. **Check the logs**:
   ```bash
   gcloud logs read "resource.type=cloud_run_revision" --limit=100
   ```

2. **Review monitoring dashboard**:
   Visit Cloud Console > Monitoring > Dashboards

3. **Run health checks**:
   ```bash
   curl https://your-app-url/health
   ```

4. **Contact support**:
   - Create an issue in the GitHub repository
   - Check existing documentation in `docs/`
   - Review troubleshooting guide in `docs/TROUBLESHOOTING.md`



## üìÑ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

**ImgStream** - Modern photo management for the cloud era üì∏‚òÅÔ∏è
